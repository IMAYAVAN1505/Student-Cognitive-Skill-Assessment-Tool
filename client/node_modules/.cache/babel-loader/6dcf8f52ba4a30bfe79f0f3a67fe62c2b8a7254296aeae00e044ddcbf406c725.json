{"ast":null,"code":"import _objectSpread from\"C:/Users/imaya/OneDrive/Desktop/project 2/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../context/AuthContext';import api from'../api';import'./Profile.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Profile(){var _user$assignedSubject;const{user,updateUser}=useAuth();const navigate=useNavigate();const[form,setForm]=useState({name:'',rollNumber:'',course:'',department:''});const[saving,setSaving]=useState(false);const[message,setMessage]=useState('');useEffect(()=>{if(user){setForm({name:user.name||'',rollNumber:user.rollNumber||'',course:user.course||'',department:user.department||''});}},[user]);const handleChange=e=>{setForm(_objectSpread(_objectSpread({},form),{},{[e.target.name]:e.target.value}));};const handleSubmit=async e=>{e.preventDefault();setSaving(true);setMessage('');try{const res=await api.put(\"/users/\".concat(user.id||user._id),form);updateUser(res.data);setMessage('Profile updated.');}catch(err){var _err$response,_err$response$data;setMessage(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Update failed');}finally{setSaving(false);}};if(!user)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-page\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-title\",children:\"Edit profile\"}),/*#__PURE__*/_jsx(\"p\",{className:\"page-desc\",children:\"Update your name and details.\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",onClick:()=>navigate('/dashboard'),children:\"Finish\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-card card\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"profile-form\",children:[message&&/*#__PURE__*/_jsx(\"div\",{className:\"profile-msg \".concat(message.includes('failed')?'error':'success'),children:message}),/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"input\",name:\"name\",value:form.name,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"input\",value:user.email,disabled:true}),user.role==='teacher'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Assigned subjects\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-readonly\",children:(_user$assignedSubject=user.assignedSubjects)!==null&&_user$assignedSubject!==void 0&&_user$assignedSubject.length?user.assignedSubjects.map(s=>(s===null||s===void 0?void 0:s.name)||s).filter(Boolean).join(', '):'None (admin assigns subjects to you)'})]}),user.role==='student'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Roll number\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"input\",name:\"rollNumber\",value:form.rollNumber,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Course\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"input\",name:\"course\",value:form.course,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Department\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"input\",name:\"department\",value:form.department,onChange:handleChange})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:saving,children:saving?'Saving...':'Save changes'})]})})]});}","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useAuth","api","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Profile","_user$assignedSubject","user","updateUser","navigate","form","setForm","name","rollNumber","course","department","saving","setSaving","message","setMessage","handleChange","e","_objectSpread","target","value","handleSubmit","preventDefault","res","put","concat","id","_id","data","err","_err$response","_err$response$data","response","className","children","style","display","justifyContent","alignItems","type","onClick","onSubmit","includes","onChange","required","email","disabled","role","assignedSubjects","length","map","s","filter","Boolean","join"],"sources":["C:/Users/imaya/OneDrive/Desktop/project 2/client/src/pages/Profile.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport api from '../api';\r\nimport './Profile.css';\r\n\r\nexport default function Profile() {\r\n  const { user, updateUser } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [form, setForm] = useState({ name: '', rollNumber: '', course: '', department: '' });\r\n  const [saving, setSaving] = useState(false);\r\n  const [message, setMessage] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      setForm({\r\n        name: user.name || '',\r\n        rollNumber: user.rollNumber || '',\r\n        course: user.course || '',\r\n        department: user.department || '',\r\n      });\r\n    }\r\n  }, [user]);\r\n\r\n  const handleChange = (e) => {\r\n    setForm({ ...form, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setSaving(true);\r\n    setMessage('');\r\n    try {\r\n      const res = await api.put(`/users/${user.id || user._id}`, form);\r\n      updateUser(res.data);\r\n      setMessage('Profile updated.');\r\n    } catch (err) {\r\n      setMessage(err.response?.data?.message || 'Update failed');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  if (!user) return null;\r\n\r\n  return (\r\n    <div className=\"profile-page\">\r\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n        <div>\r\n          <h1 className=\"page-title\">Edit profile</h1>\r\n          <p className=\"page-desc\">Update your name and details.</p>\r\n        </div>\r\n        <button type=\"button\" className=\"btn btn-secondary\" onClick={() => navigate('/dashboard')}>\r\n          Finish\r\n        </button>\r\n      </div>\r\n      <div className=\"profile-card card\">\r\n        <form onSubmit={handleSubmit} className=\"profile-form\">\r\n          {message && <div className={`profile-msg ${message.includes('failed') ? 'error' : 'success'}`}>{message}</div>}\r\n          <label className=\"label\">Name</label>\r\n          <input type=\"text\" className=\"input\" name=\"name\" value={form.name} onChange={handleChange} required />\r\n          <label className=\"label\">Email</label>\r\n          <input type=\"text\" className=\"input\" value={user.email} disabled />\r\n          {user.role === 'teacher' && (\r\n            <>\r\n              <label className=\"label\">Assigned subjects</label>\r\n              <div className=\"profile-readonly\">\r\n                {(user.assignedSubjects?.length\r\n                  ? user.assignedSubjects.map(s => s?.name || s).filter(Boolean).join(', ')\r\n                  : 'None (admin assigns subjects to you)')}\r\n              </div>\r\n            </>\r\n          )}\r\n          {user.role === 'student' && (\r\n            <>\r\n              <label className=\"label\">Roll number</label>\r\n              <input type=\"text\" className=\"input\" name=\"rollNumber\" value={form.rollNumber} onChange={handleChange} />\r\n              <label className=\"label\">Course</label>\r\n              <input type=\"text\" className=\"input\" name=\"course\" value={form.course} onChange={handleChange} />\r\n              <label className=\"label\">Department</label>\r\n              <input type=\"text\" className=\"input\" name=\"department\" value={form.department} onChange={handleChange} />\r\n            </>\r\n          )}\r\n          <button type=\"submit\" className=\"btn btn-primary\" disabled={saving}>\r\n            {saving ? 'Saving...' : 'Save changes'}\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}